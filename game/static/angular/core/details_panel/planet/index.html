<div class="tab-container tile">
    <ul class="nav tab nav-tabs">
        <li ng-repeat="tab in tabs">
            <a ui-sref="{{tab.route}}">{{tab.heading}}</a>
        </li>
    </ul>

    <div class="tab-content">
        <ui-view>
            <ul class="list-unstyled">
                <li><b>Type:</b> {{ planet.type }}</li>
                <li><b>ID:</b> {{ planet.id }}</li>
            </ul>
            Planet description
            Planet description
            Planet description
            Planet description
            Planet description
            Planet description
            Planet description
            Planet description
            Planet description
            Planet description
            Planet description
            Planet description
            <hr />
            Rich in various resources.<br />
            May contain some rare earth elements.<br />
            No solid structures are built on this planet.<br />
            Buildings: Building1, Building2, ...
        </ui-view>
    </div>
</div>

<tabset>
<tab
        ng-repeat="building in planet.buildings track by $index"
        heading="{{building.type}}"
        select="changeBuilding(building)">
<div when="Shipyard">
    <!--<h4>Available ships</h4>-->
    <table class="table table-hover">
        <thead>
        <tr>
            <th>Ship</th>
            <th>Resources</th>
            <th>ETA</th>
            <th>Order</th>
        </tr>
        </thead>
        <tbody ng-init="ship_resources=controlPanel.currentShipDetails.resources">
        <tr ng-repeat="(ship, details) in building.available_ships">
            <td>{{ship}}</td>
            <td>
                <ul class="list-unstyled">
                    <li
                            ng-repeat="(resource, quantity) in details.resources"
                            ng-class="{true:'text-success', false:'text-danger'}[ship_resources[resource] > quantity]"
                            >
                        {{resource}}: {{quantity}}
                    </li>
                </ul>
            </td>
            <td>{{details.time}}s</td>
            <td><button class="btn btn-default btn-sm" ng-click="order(building.id, ship)">Order</button></td>
        </tr>
        </tbody>
    </table>
    <!--
    <h4>Queue</h4>
    <table class="table table-hover">
        <thead>
        <tr>
            <th>Ship</th>
            <th>Contractor</th>
            <th>ETA</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>Raven</td>
            <td>test</td>
            <td>5:30</td>
        </tr>
        <tr>
            <td>Owl</td>
            <td>test</td>
            <td>15:23</td>
        </tr>
        </tbody>
    </table>
    -->
</div>
<div when="Warehouse">
    <br />
    Warehouse allows you to store your resources.
    <table class="table table-hover">
        <thead>
        <tr>
            <th>Resource</th>
            <th>Warehouse</th>
            <th>Ship</th>
            <th>Quantity</th>
            <th>Load</th>
            <th>Unload</th>
        </tr>
        </thead>
        <tbody ng-init="resources=warehouseResources(building)"> <!-- TODO -->
        <tr ng-repeat="(resource, details) in resources track by $index">
            <td>{{resource}}</td>
            <td ng-click="detailsPanel.warehouse_quantities[$index]=details.warehouse">
                <a href="#">{{details.warehouse}}</a>
            </td>
            <td ng-click="detailsPanel.warehouse_quantities[$index]=details.ship">
                <a href="#">{{details.ship}}</a>
            </td>
            <td><input class="form-control input-sm" style="width: 50px" type="text" ng-model="detailsPanel.warehouse_quantities[$index]"/></td>
            <td>
                <button class="btn btn-default btn-sm" ng-click="store(building.id, resource, detailsPanel.warehouse_quantities[$index], 'load')">
                    Load
                </button>
            </td>
            <td>
                <button class="btn btn-default btn-sm" ng-click="store(building.id, resource, detailsPanel.warehouse_quantities[$index], 'unload')">
                    Unload
                </button>
            </td>
        </tr>
        </tbody>
    </table>
</div>
<div ng--when="Workshop">
    <br />
    <h4>Available components</h4>
    Workshop allows you to buy new, or upgrade existing ship components.<br />
    Keep in mind that most ships can utilize only one component of particular type.
    Usually there is no point to buy two engines, or drills.
    <table class="table table-hover">
        <thead>
        <tr>
            <th>Component</th>
            <th>Requirements</th>
            <th>ETA</th>
            <th>Parameters</th>
            <th>Order</th>
        </tr>
        </thead>
        <tbody class="text-nowrap">
        <tr ng-repeat="(component, details) in building.processes">
            <td>{{component}} Mk {{details.mark}}</td>
            <td>
                <ul class="list-unstyled">
                    <li
                            ng-repeat="(requirement, quantity) in details.requirements"
                            ng-class="{true:'text-success', false:'text-danger'}[controlPanel.currentShipDetails.resources[requirement] >= quantity]"
                            >
                        {{requirement}}: {{quantity}}
                    </li>
                </ul>
            </td>
            <td>{{details.time}}s</td>
            <td>
                <ul class="list-unstyled">
                    <li ng-repeat="(parameter, value) in details.parameters">
                        {{parameter}}: {{value|number}}
                    </li>
                </ul>
            </td>
            <td>
                <button class="btn btn-default btn-sm" ng-click="order(building.id, component, 1)" ng-hide="workshopLocked || controlPanel.currentShipDetails.locked">
                    {{details.mark > 1 ? "Upgrade" : "Order"}}
                </button>
            </td>
        </tr>
        </tbody>
    </table>
    <hr />
    <h4>Cargo</h4>
    Your cargo contains following components.<br />
    You can attach them to current ship in Workshop, store in Warehouse, sell in the Marketplace or retrieve some materials in Recycler.
</div>

<div ng-if="building.type == 'Factory' || building.type == 'Smelter' || building.type == 'Refinery'">
    <p ng--when="Factory">
        Factory
    </p>
    <p ng--when="Smelter">
        Industrial plant that allows to change raw materials into metals.
    </p>
    <p ng--when="Refinery">
        Industrial plant that allows to change raw materials into metals.
    </p>
    <hr />
    <table class="table table-hover">
        <thead>
        <tr>
            <th>Resource</th>
            <th>Requirements</th>
            <th>ETA</th>
            <th>Qty</th>
            <th>Order</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="(resource, details) in building.processes" ng-init="details.quantity=1">
            <td>{{resource}}</td>
            <td>
                <ul class="list-unstyled">
                    <li
                            ng-repeat="(requirement, quantity) in details.requirements"
                            ng-class="{true:'text-success', false:'text-danger'}[controlPanel.currentShipDetails.resources[requirement] >= quantity * (details.quantity || 1)]"
                            >
                        {{requirement}}: {{quantity * (details.quantity || 1)}}
                    </li>
                </ul>
            </td>
            <td>{{details.time * (details.quantity || 1)}}s</td>
            <td><input class="form-control input-sm" style="width: 50px" type="text" ng-model="details.quantity"/></td>
            <td><button class="btn btn-default btn-sm" ng-click="order(building.id, resource, details.quantity || 1)">Order</button></td>
        </tr>
        </tbody>
    </table>
</div>
</div>
</tab>
</tabset>